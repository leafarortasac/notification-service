Notification Service (Consumer & History) ğŸ””ğŸ“‚

O Notification Service Ã© o componente responsÃ¡vel por garantir que as informaÃ§Ãµes sobre o ciclo de vida das tarefas cheguem aos interessados finais. Ele atua como um Worker assÃ­ncrono, consumindo eventos do RabbitMQ, persistindo o histÃ³rico de notificaÃ§Ãµes no MongoDB e disparando alertas em tempo real.

ğŸ¯ Responsabilidades
Mensageria (Consumer): Escuta a fila task.created.queue e processa os eventos disparados pelo Task-Service em tempo real.

PersistÃªncia de HistÃ³rico (NoSQL): Armazena cada notificaÃ§Ã£o enviada no MongoDB para fins de auditoria, reenvio e histÃ³rico do usuÃ¡rio.

Disparo de Alertas: IntegraÃ§Ã£o preparada para repassar notificaÃ§Ãµes via protocolos leves (como MQTT) ou Logs de sistema.

SeguranÃ§a (IAM): Utiliza o IAM-Service para proteger os endpoints de consulta ao histÃ³rico de notificaÃ§Ãµes via JWT.

TransformaÃ§Ã£o de Dados: Converte os eventos recebidos (TaskRepresentation) em documentos de domÃ­nio para persistÃªncia.

ğŸ› ï¸ Tecnologias
Java 21 & Spring Boot 3.4: Base moderna e performÃ¡tica.

Spring Data MongoDB: PersistÃªncia de documentos de histÃ³rico de forma flexÃ­vel.

Spring AMQP: IntegraÃ§Ã£o robusta para consumo de filas do RabbitMQ.

Spring Security & JWT: ProteÃ§Ã£o de endpoints de consulta.

Swagger/OpenAPI: DocumentaÃ§Ã£o interativa da API de consulta.

Lombok & MapStruct: Produtividade e mapeamento de objetos.

ğŸ“– DocumentaÃ§Ã£o da API (Swagger)
Embora sua funÃ§Ã£o principal seja o consumo de mensagens, o serviÃ§o expÃµe endpoints para que o usuÃ¡rio ou o Front-end consulte seu histÃ³rico de notificaÃ§Ãµes.
ğŸ”— Acesse em: http://localhost:8082/swagger-ui.html

Nota de SeguranÃ§a: Todas as rotas de consulta exigem um Token JWT vÃ¡lido no Header Authorization: Bearer <TOKEN>.

ğŸ” ConfiguraÃ§Ã£o de Ambiente
O serviÃ§o utiliza as seguintes variÃ¡veis para garantir a conectividade no ecossistema:

IAM_JWT_SECRET: Segredo para validaÃ§Ã£o de tokens nas rotas de consulta.

SPRING_DATA_MONGODB_URI: ConexÃ£o com o cluster MongoDB (notifications_db).

SPRING_RABBITMQ_HOST: EndereÃ§o do broker RabbitMQ (task-rabbit).

ğŸ”„ Fluxo de Processamento
O serviÃ§o permanece em listen na fila do RabbitMQ.

Assim que o Task-Service posta uma mensagem de criaÃ§Ã£o/alteraÃ§Ã£o, o Notification-Service a captura.

O payload Ã© processado e transformado em um documento de HistÃ³rico de NotificaÃ§Ã£o.

A notificaÃ§Ã£o Ã© persistida no MongoDB.

(Opcional) O evento Ã© encaminhado para o Broker MQTT para atualizaÃ§Ã£o em tempo real no Front-end.

ğŸ“¦ Como rodar localmente
Certifique-se de que o Shared Contracts foi instalado localmente (mvn install).

Garanta que os containers do MongoDB e RabbitMQ estejam rodando via Docker Compose.

Execute o comando:

Bash
mvn spring-boot:run